#! /must/source/this/file
################################################################
#	Initialize Environment
################################################################
# [0] must SOURCE this file
# [1] must be in home directory
# [2] init must be a symlink or a real directory
# [3] everything in init gets symlinked to home
# [4] previous versions saved in ~/.save.$$
################################################################

SAVE=.save.$(date +%H%M)
INIT=._

test -d $INIT || return

mkdir -p $SAVE

ls -a ._/. |
while read x
do
	case $x in
	(.|..)		continue;;
	(.svn)		continue;;
	(CVS)		continue;;
	(.profile)	continue;;
	(setup)		continue;;
	 (*~)		continue;;
	(.*~)		continue;;
	(.ssh)	test -e $x && mv .ssh $SAVE
		rsync -aC ._/.ssh .
		#@ mkdir .ssh
		#@ (cd   .ssh && ln -s  ../._/.ssh/* .)
		#@ rm    .ssh/authorized_keys
		#@ cp ._/.ssh/authorized_keys .ssh
		#@ rm    .ssh/known_hosts
		#@ cp ._/.ssh/known_hosts     .ssh
			continue;;
	(.?)	test -f $x || cp -r $INIT/$x .
			continue;;
	esac

	test -e	$x &&
	mv	$x $SAVE
	ln -s	$INIT/$x .
done

source .bash_profile

################################################################
