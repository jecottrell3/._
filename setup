#! /must/source/this/file
# $Id$
################################################################
#	Initialize Environment
################################################################
# [0] must SOURCE this file
# [1] must be in home directory
# [2] $INIT must be a symlink or a real directory
# [3] everything in $INIT gets symlinked to home, except
# [4] .SSH is rsync'ed, and copied to .ssh if it doesn't exist
# [5] previous versions saved in ~/.save.$$
# [6] certain overhead files ignored.
################################################################

SAVE=.save.$(date +%H%M)
INIT=._

test -d $INIT || return

mkdir -p $SAVE

ls -a ._/. |
while read x
do
	case $x in
	(.|..)		continue;;
	(.svn)		continue;;
	(CVS)		continue;;
	(.profile)	continue;;
	(setup)		continue;;
	(setdn)		continue;;
	 (*~)		continue;;
	(.*~)		continue;;
	(.SSH)	rsync -rC ._/$x .
		test -e .ssh || mv .SSH .ssh;;
	(.ssh)	test -w / && continue # skip if root
		test -e $x && mv $x $SAVE; rsync -rC ._/$x .;;
	(*)	test -e	$x && mv $x $SAVE; ln -s  $INIT/$x .;;
	esac
done

pwd
ls -l    .bash_profile
ls -lL   .bash_profile
source ./.bash_profile

################################################################
