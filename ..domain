test -f $DEBUG && echo ..domain
test -s $DEBUG && set -x
export	TZ=EST5EDT
test -d /Applications && MAC=1 || MAC=0
#################################################################
#	Do Domain Specific Customization
#################################################################

	  HOST=$(hostname -s)
	  FQDN=$(hostname -f)
if	((MAC))
then	DOMAIN=$NIH IP=too-hard-for-now
else
	DOMAIN=$(hostname -d)
	    IP=$(hostname -i)
fi

set +x
export	H=$HOST	D=$DOMAIN	NIH=nih.gov
export	NIA=nia.$NIH		NLM=nlm.$NIH

if	egrep -q homerj     /etc/resolv.conf
then	SEARCH=homerj
fi

 nih="source $RBJ/..nih"
 nia="source $RBJ/..nia"
 nlm="source $RBJ/..nlm"

case ${DOMAIN:-$SEARCH} in
(bytecubed.com|u.group)
	echo Welcome to The U
	#GITLAB=it-gitlab.junipercloud.net	# 10.76.7.70 10.76.18.102
	#GITTOP=https://$GITLAB/infosec/operations-sunrise

	JC2=ec2-54-89-70-224.compute-1.amazonaws.com
	JC3=ec2-54-83-108-51.compute-1.amazonaws.com
	alias	pem='ssh-add ~/.ssh/*.pem'
	alias	jc2="ssh ec2-user@$JC2"
	alias	jc3="ssh   ubuntu@$JC3"

	# TAOS/JUNIPER
	#export	JHOST=ldap://dcjnprjpsvl1.jnpr.net
	#export	JBIND=jcottrell@JNPR.NET
	#export	JBASE=dc=jnpr,dc=net
	#alias	jds="ldapsearch -LLL -H $JHOST -N -D $JBIND -b $JBASE"
	;;
(homerj)
	echo Welcome to HOMERJ
	export D=homerj
	export PRINTER=lp LPDEST=lp
	;;
(ncbi.nlm.nih.gov)
#	$nlm
	echo Welcome to NCBI
	export	NCBI=ncbi.$NLM M=be-md V=st-va
	export	MD=$M.$NCBI VA=$V.$NCBI
	export	QA=be-md.qa.$NCBI
	export	ncbiBASE=dc=ncbi,dc=nlm,dc=nih,dc=gov

	alias	nds="ldapsearch -b ou=Devices,$ncbiBASE"
	alias	pdc="package_deployment create"

	# nack args: ticket host reason...
	function nack { nagios_ack -h   ${2?'no host'} -d 48 -c "$*"; }
	function cold { cons --ipmitool ${1?'no host'} mc reset cold; }
	function bios { cons --ipmitool ${1?'no host'} chassis bootdev bios; }
	function  pxe { cons --ipmitool ${1?'no host'} chassis bootdev  pxe; }

	alias	 LDisks='MegaCli -LDInfo -Lall -Aall'
	alias	 PDisks='MegaCli -PDList       -Aall'
	alias	Battery='MegaCli -AdpBbuCmd -GetBbuStatus -Aall'
	alias	  Learn='MegaCli -AdpBbuCmd -BbuLearn -Aall'
	alias	 Stripe='MegaCli -CfgLdAdd -R 0 '
	alias	 Mirror='MegaCli -CfgLdAdd -R 1 '
	alias	  RAID5='MegaCli -CfgLdAdd -R 5 '
	alias	 NoRaid='MegaCli -CfgLdDel -L '

	function pcc { ssh root@puppetca.$M puppet cert --clean $1.$MD; }
	function pcv { ssh root@puppetca.$V puppet cert --clean $1.$VA; }
	function pat { ssh root@${1:-$(hostname)} time puppet agent -t; }
	function rat
	{
		test -w / && SUDO=eval || SUDO=sudo
		CMD="time puppet agent -t"
		case $# in
		(0)	CMD="$SUDO $CMD";;
		(*)	CMD="ssh -tAX root@$1 $CMD";;
		esac
		echo $CMD; eval $CMD
	}
	alias	rpu='rake puppetmaster:update:be-md'
	alias	rpv='rake puppetmaster:update:st-va'
	alias	rps='rake puppetmaster:restart:be-md'
	alias	rpw='rake puppetmaster:restart:st-va'
	;;
(*nih.gov)
#	$nih
	echo Welcome to NIH
	export	BASE=ou=NIH,OU=AD,DC=NIH,DC=gov

	#alias	lds="ldapsearch -b $BASE -h ldapad.nih.gov"
	#alias	ldx="ldapsearch -b $BASE -h strudel.cit.nih.gov -x"

	export	TFTP=/var/lib/tftpboot
	export	MENU=$TFTP/pxelinux.cfg
	export	IMGS=$TFTP/images
	;;
(*)
	echo Welcome to NOWHERE;;
esac

# Script OnEach

soe()
{
	OPTS=$-
	set "$@"
	file=$1; shift
	script $file -c "oneach -aSp $*"
	set $OPTS
}

#################################################################

#ource	/root/ks.vars			# TEMPORARY

YI() { for x in $(<$1); do rpm -q $x || sudo yum install $x; done; }
YR() { for x in $(<$1); do rpm -q $x && sudo yum remove $x | grep -v ^--;done; }
YN() { yum info $(<$1) | less -j1 +/'^Name.*'; }
YY() { while read x; do yum info "*$x*" | less -j1 +/'^Name.*'; done; }

#################################################################
tw() { time wordsin $*; }
set +x
