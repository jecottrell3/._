#! /bin/sh -x

OLD=${2:-jcottrell}
NEW=${1:-rbj}

cd /etc

grep $OLD group ||
{
	echo need to add $OLD first
	exit 1
}

grep $NEW group &&
{
	echo $NEW already added
	exit 1
}

for FILE in group passwd shadow
do
	grep $NEW $FILE ||
	{
		cp -p $FILE $FILE.old
# jc, rbj	sed "/^$OLD/{p;s//$NEW/;}"   $FILE.old > $FILE
# rbj, jc	sed "/^$OLD/{h;s//$NEW/;G;}" $FILE.old > $FILE
		sed "/^$OLD/{h;s//$NEW/;G;}" $FILE.old > $FILE
	}
done

exec sed -ie "s/$OLD$/$OLD,$NEW/" group
